
import plotly.graph_objects as go
import json

# Parse the data
data = {"categories": [{"category": "STATE PARKS & NATURAL AREAS", "destinations": [{"name": "Carnifex Ferry Battlefield State Park", "distance": "5.7 miles / 9 min", "activities": ["Civil War History", "Hiking Trails", "Gauley River Overlooks", "Battle Reenactments"], "crossLinks": ["Gauley River access", "Historical context for region", "Three overlooks of canyon"], "notes": "On rim of Gauley River Canyon; odd-year reenactments"}, {"name": "Hawks Nest State Park", "distance": "25-30 miles / 35-40 min", "activities": ["Scenic Overlook", "Aerial Tramway", "Jetboat Rides", "Hiking", "Museum"], "crossLinks": ["New River Gorge views", "Adventure activities hub", "Scenic overlook of gorge"], "notes": "10 miles north of New River Gorge Bridge; 31-room lodge"}, {"name": "Babcock State Park", "distance": "25 miles / 40 min", "activities": ["Glade Creek Grist Mill", "Hiking (20+ trails)", "Boating", "Fishing", "Mountain Biking"], "crossLinks": ["4,127 acres scenic tourism", "Historic mill photography", "Boley Lake access"], "notes": "20 miles SE of New River Gorge Bridge; campground available spring-fall"}, {"name": "Summersville Lake State Park", "distance": "Integrated at lake", "activities": ["Hiking (3.5 miles)", "Climbing (220+ routes)", "Scenic Overlook", "Pirate's Cove access"], "crossLinks": ["220 climbing routes", "NEW state park (36th in WV)", "Primary lake activities hub"], "notes": "West Virginia's first state park with climbing programs; 177 acres northern shore"}, {"name": "New River Gorge National Park", "distance": "30-40 miles / 40-50 min", "activities": ["Hiking (Long Point Trail 3.2 mi)", "Scenic Drives", "Bridge overlooks", "Photography"], "crossLinks": ["Free entrance", "Long Point Trail to Gorge views", "Endless Wall trail access"], "notes": "70,000 acres; 53 miles of New River; Long Point differs from Summersville version"}]}, {"category": "WHITEWATER RAFTING & GAULEY RIVER", "destinations": [{"name": "Gauley River - Upper Section", "distance": "Direct from dam / 0 min", "activities": ["Class V Whitewater Rafting", "Kayaking", "Technical Rapids"], "crossLinks": ["World-class rapids", "September-October season", "5 Class V rapids"], "notes": "14-mile run; 70 ft/mile gradient; 5 Class V rapids; requires experience/16+ age"}, {"name": "Gauley River - Lower Section", "distance": "Direct from dam / 0 min", "activities": ["Class III-V Rafting", "Scenic paddling", "Calm sections"], "crossLinks": ["13-14 mile run", "More scenic than technical", "Family-friendly option"], "notes": "40+ rapids; 35 ft/mile gradient; 3 Class V rapids; swimming holes available"}, {"name": "Gauley River National Recreation Area", "distance": "Directly below dam", "activities": ["Rafting (25 miles)", "Private paddling", "Camping"], "crossLinks": ["11,000 acres total", "25 miles Gauley + 5.5 miles Meadow", "Remote canyon setting"], "notes": "Gauley Season: Labor Day weekend through October (6-7 weekends)"}, {"name": "Gauley Tailwaters Campground", "distance": "Adjacent to Gauley River", "activities": ["Camping", "River access", "Recreation"], "crossLinks": ["First-come camping", "Direct rafting access", "Support infrastructure"], "notes": "Primitive campground directly next to Gauley River"}]}, {"category": "HIKING & TRAILS", "destinations": [{"name": "Long Point Trail (Summersville Lake)", "distance": "Integrated at lake", "activities": ["Easy hiking", "Lake overlook", "Photography"], "crossLinks": ["Almost Heaven swing", "0.7-1.0 mile scenic walk", "Low difficulty access"], "notes": "Easy family trail; scenic lake and cliff views"}, {"name": "Long Point Trail (New River Gorge)", "distance": "30-40 miles / 40-50 min", "activities": ["Moderate hiking (3.2 mi)", "Gorge views", "Bridge overlook"], "crossLinks": ["1.5-2 hour hike", "New River Gorge Bridge views", "350 ft elevation gain"], "notes": "DO NOT CONFUSE: different location than Summersville Lake version; bikes allowed except last 0.2 mi"}, {"name": "Cranberry Tri-River Rail Trail", "distance": "40 minutes / 16 miles (east)", "activities": ["Dirt/gravel trail hiking", "Biking", "Nature walk"], "crossLinks": ["16 miles total", "Cranberry Glades access", "Falls of Hills Creek"], "notes": "Trailhead in Richwood; connects to Falls of Hills Creek"}, {"name": "Highland Scenic Highway", "distance": "45-60 min (via Richwood)", "activities": ["Scenic driving", "Hiking access", "Overlook stops"], "crossLinks": ["43-mile National Scenic Byway", "4 scenic overlooks", "Cranberry Glades Botanical Area"], "notes": "WV Route 150 section not maintained winter; rises to 4,500 ft elevation"}]}, {"category": "ROCK CLIMBING", "destinations": [{"name": "Summersville Lake - Orange Oswald", "distance": "Integrated at lake", "activities": ["Deep Water Soloing", "Rope climbing", "Lake swimming"], "crossLinks": ["Cliff jumping into lake", "Multiple climbing areas", "Summer accessibility"], "notes": "DWS made legal 2016 for anniversary; accessible from water"}, {"name": "Summersville Lake - Pirate's Cove", "distance": "Integrated at lake", "activities": ["Rock climbing", "Waterfall access", "Photography"], "crossLinks": ["Waterfall with overhanging walls", "220+ routes at park", "World-class climbing"], "notes": "Paddle to cove; waterfall creates unique aesthetic"}, {"name": "Whippoorwill Area - Summersville", "distance": "On/near lake", "activities": ["Beginner-friendly climbing", "Swimming", "DWS summer"], "crossLinks": ["Great for learning", "Summer moderate routes", "Winter/spring headpoint access"], "notes": "Best beginner climbing near Summersville Lake area"}, {"name": "New River Gorge - 3,000+ Routes", "distance": "30-40 miles / 40-50 min", "activities": ["Sport climbing", "Trad climbing", "Bouldering"], "crossLinks": ["3,000+ established routes", "60 miles of cliffline", "Over 60 bouldering areas"], "notes": "One of East's largest climbing destinations; Nuttall sandstone 98% quartz"}, {"name": "Carnival (Coliseum) Area", "distance": "On lake", "activities": ["Advanced climbing", "High difficulty routes"], "crossLinks": ["5.15 routes available", "Technical climbing access", "Year-round climbing possible"], "notes": "One of world's best climbing areas"}]}, {"category": "WILDLIFE MANAGEMENT AREAS", "destinations": [{"name": "Summersville Lake WMA", "distance": "Integrated at lake", "activities": ["Hunting", "Fishing", "Wildlife viewing"], "crossLinks": ["5,974 acres", "2,418 acres water surface", "Primary fishing access"], "notes": "Part of Summersville Lake management; smallmouth bass fishery"}, {"name": "Meadow River WMA", "distance": "15-20 miles / 20-25 min (south/downriver)", "activities": ["Hunting (turkey, deer, grouse, waterfowl)", "Fishing (Meadow River)", "Wildlife viewing"], "crossLinks": ["2,385 acres riverine habitat", "Wetlands ecosystem", "Multi-species hunting opportunity"], "notes": "Located in Greenbrier County near Rupert; no camping; Babcock SP camping nearby"}, {"name": "Pinchot Sycamore WMA", "distance": "40-50 miles (Hawks Nest area)", "activities": ["Hunting grounds", "Wildlife habitat"], "crossLinks": ["Near Babcock State Park", "Park boundary access", "Secondary species target area"], "notes": "Located at Hawks Nest area boundary"}]}, {"category": "CAVES & GEOLOGICAL", "destinations": [{"name": "Organ Cave", "distance": "50-60 miles / 70-90 min (south to Greenbrier County)", "activities": ["Guided cave tours", "Fossil hunting", "Civil War history", "Walking museum trail"], "crossLinks": ["45+ miles mapped passages", "Historic landmark", "Only commercial cave in state"], "notes": "2nd longest commercial cave in US; currently closed for renovations; fossil tours available"}, {"name": "Summersville Lake Scuba Diving", "distance": "Integrated at lake", "activities": ["Scuba diving", "Underwater exploration", "Crystal clear water"], "crossLinks": ["'Little Bahamas of East'", "High visibility (near 100 ft)", "Unique freshwater diving"], "notes": "Sarge's Dive Shop on-site; certification available; explore underwater landscape"}]}, {"category": "SCENIC DRIVES & SCENIC BYWAYS", "destinations": [{"name": "Highland Scenic Highway", "distance": "45-60 min (via Richwood east)", "activities": ["43-mile scenic drive", "Overlook stops", "Mountain views"], "crossLinks": ["National Scenic Byway", "Monongahela National Forest", "Cranberry Glades access"], "notes": "WV Routes 39, 55, 150; 4,500 ft elevation; spring/fall best; winter travel caution"}, {"name": "New River Gorge Scenic Corridor", "distance": "30-40 miles / 40-50 min", "activities": ["Scenic driving", "Gorge overlooks", "Bridge views"], "crossLinks": ["US Route 19 corridor", "Bridge Day events (3rd Sat Oct)", "Historic scenic route"], "notes": "New River Gorge Bridge 876 ft high; foot traffic only on Bridge Day"}, {"name": "Gauley Mountain Loop", "distance": "Variable", "activities": ["Mountain scenic drive", "Local culture", "Rural Appalachia views"], "crossLinks": ["Regional scenic route", "Historic roads", "Gateway to adventure"], "notes": "Local roads through mountain terrain; combine with rafting season access"}]}, {"category": "TOWNS & SERVICES/INFRASTRUCTURE", "destinations": [{"name": "Summersville (County Seat)", "distance": "3-8 miles / 5-15 min", "activities": ["Shopping", "Dining", "Services", "Community hub"], "crossLinks": ["Food Lion (Industrial Dr)", "Save-A-Lot (Broad St)", "Multiple gas stations (Go Mart, Sheetz, BP, Exxon)"], "notes": "Full service town; grocery stores open 7-10 PM; multiple fuel stations"}, {"name": "Summersville Regional Medical Center", "distance": "3-8 miles / 5-15 min", "activities": ["Emergency care (24/7)", "Medical services", "Rural health clinic"], "crossLinks": ["Full-service hospital", "WVU Medicine network", "Telemedicine specialists"], "notes": "24-hour emergency; outpatient services; skilled nursing; part of WVU Medicine"}, {"name": "Fayetteville", "distance": "30 miles / 40 min (north)", "activities": ["Adventure headquarters", "Dining", "Zip lining", "Climbing guides"], "crossLinks": ["Adventures on the Gorge", "New River Mountain Guides", "Specialty restaurants"], "notes": "Major tourism hub for New River Gorge; full commercial services"}]}, {"category": "SPECIALIZED RECREATION & SERVICES", "destinations": [{"name": "ACE Adventure Resort", "distance": "35 miles / 50 min (Fayetteville)", "activities": ["Rafting (Gauley/New)", "Kayaking", "Mountain biking", "Zip lining", "Camping", "Cabins"], "crossLinks": ["North America's largest adventure resort", "Multiple river access", "Equipment rentals"], "notes": "40+ years in region; 1,500-acre resort; full infrastructure"}, {"name": "Adventures on the Gorge", "distance": "35-40 miles / 45-50 min", "activities": ["Rafting", "Zip lining", "Canopy tours", "Luxury camping"], "crossLinks": ["Deluxe Gauley overnight", "Gauley Marathon day trips", "Platform tents/hot tubs"], "notes": "Premium adventure packages; diverse activity menu"}, {"name": "Sarge's Dive Shop (Summersville Lake)", "distance": "Integrated at lake", "activities": ["Scuba certification", "Equipment rental", "Paddleboard/kayak rental"], "crossLinks": ["Lake gear hub", "Certification on-site", "Multi-sport rentals"], "notes": "One-stop for water sports gear and instruction"}, {"name": "Lakeside Outfitters", "distance": "On/near lake", "activities": ["Paddleboard rentals", "Guided paddling tours", "Kayak access"], "crossLinks": ["$65/2-hour paddle tours", "Pirate's Cove access", "Multi-activity combinations"], "notes": "Guided tours and rentals for paddling activities"}]}]}

# Prepare data for table
categories = []
destinations = []
distances = []
activities = []
cross_links = []
notes = []

for cat_data in data['categories']:
    category = cat_data['category']
    for dest in cat_data['destinations']:
        categories.append(category)
        destinations.append(dest['name'])
        distances.append(dest['distance'])
        # Join activities with line breaks for readability
        activities.append('<br>'.join(['• ' + a for a in dest['activities']]))
        # Join cross-links with line breaks
        cross_links.append('<br>'.join(['• ' + c for c in dest['crossLinks']]))
        notes.append(dest['notes'])

# Create the table
fig = go.Figure(data=[go.Table(
    columnwidth=[100, 150, 90, 150, 150, 180],
    header=dict(
        values=['<b>Category</b>', '<b>Destination Name</b>', '<b>Distance/<br>Drive Time</b>', 
                '<b>Primary Activities</b>', '<b>Key Cross-Link<br>Features</b>', '<b>Accessibility Notes</b>'],
        fill_color='#1FB8CD',
        align=['left', 'left', 'left', 'left', 'left', 'left'],
        font=dict(color='white', size=11),
        height=40
    ),
    cells=dict(
        values=[categories, destinations, distances, activities, cross_links, notes],
        fill_color=[['#f8f9fa' if i % 2 == 0 else 'white' for i in range(len(categories))]],
        align=['left', 'left', 'left', 'left', 'left', 'left'],
        font=dict(color='#13343B', size=9),
        height=65
    )
)])

fig.update_layout(
    title={
        'text': "Cross-Linking Opportunities for Multi-Activity Trips<br><span style='font-size: 18px; font-weight: normal;'>Comprehensive matrix showing connectivity across 35+ destinations</span>",
        'x': 0.5,
        'xanchor': 'center'
    }
)

# Save as PNG and SVG
fig.write_image('cross_link_matrix.png')
fig.write_image('cross_link_matrix.svg', format='svg')
