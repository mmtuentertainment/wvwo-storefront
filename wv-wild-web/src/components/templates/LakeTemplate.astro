---
/**
 * LakeTemplate.astro
 * SPEC-13: Lake Adventure Template Component
 *
 * Comprehensive template for West Virginia lake pages with fishing-centric content,
 * marina details, camping facilities, and seasonal activity guides.
 *
 * USER STORIES IMPLEMENTED:
 * - US1: Fishing Information Display (What to Fish + Where to Fish sections)
 * - US2: Marina & Camping Facilities (trip planning features)
 * - US3: Hero Section with Lake Stats (visual impact + quick facts)
 * - US4: Activities & Seasonal Guide (beyond-fishing content)
 * - US5: Safety & Regulations Display (orange warning accents)
 *
 * WVWO COMPLIANCE:
 * - Fonts: font-display (headings), font-hand (Kim's tips ONLY), font-body (content)
 * - Colors: brand-brown, sign-green, brand-cream, brand-orange (<5% of screen)
 * - Borders: rounded-sm ONLY (no rounded-md/lg/xl)
 * - Accents: Green (fishing), Brown (spots/marina), Orange (regulations)
 *
 * @module components/templates/LakeTemplate
 */

import Layout from '../../layouts/Layout.astro';
import AdventureWhatToFish from '../adventure/AdventureWhatToFish.astro';
import AdventureCampingList from '../adventure/AdventureCampingList.astro';
import AdventureQuickStats from '../adventure/AdventureQuickStats.astro';
import AdventureAmenitiesGrid from '../adventure/AdventureAmenitiesGrid.astro';
import AdventureGearChecklist from '../adventure/AdventureGearChecklist.astro';
import AdventureRelatedShop from '../adventure/AdventureRelatedShop.astro';
import AdventureCTA from '../adventure/AdventureCTA.astro';
import type { LakeTemplateProps, FishingSpot, Marina, Activity, SeasonalGuide, Regulation } from '../../types/adventure';

interface Props extends LakeTemplateProps {}

const {
  name,
  image,
  imageAlt,
  tagline,
  description,
  stats,
  fishingSpots,
  marinas,
  activities,
  seasonalGuide,
  regulations,
  gearList,
  relatedShop,
  difficulty,
  bestSeason,
  coordinates,
} = Astro.props;

// Build-time Zod validation would go here in production
// Example: LakeTemplatePropsSchema.parse(Astro.props);
---

<Layout title={`${name} | WV Wild Outdoors`}>
  <!-- US3: HERO SECTION WITH LAKE STATS (T035-T047) -->
  <section
    class="relative h-[70vh] min-h-[500px] overflow-hidden"
    aria-label={`${name} hero section`}
  >
    <!-- Hero Image -->
    <img
      src={image}
      alt={imageAlt}
      class="absolute inset-0 w-full h-full object-cover"
      loading="eager"
    />

    <!-- Dark Overlay for Text Readability -->
    <div class="absolute inset-0 bg-brand-brown/50"></div>

    <!-- Hero Content -->
    <div class="relative h-full container mx-auto px-4">
      <div class="h-full flex flex-col justify-end pb-16">
        <!-- Lake Name -->
        <h1 class="font-display text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-6">
          {name}
        </h1>

        <!-- Tagline -->
        {tagline && (
          <p class="font-body text-xl md:text-2xl text-brand-cream mb-8 max-w-2xl">
            {tagline}
          </p>
        )}

        <!-- Quick Stats Grid (4-column desktop, 2-column mobile) -->
        {stats.length > 0 && (
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-brand-cream mb-6">
            {stats.map((stat) => (
              <div class="stat-item">
                <div class="text-sm uppercase tracking-wide opacity-80 mb-1">
                  {stat.label}
                </div>
                <div class="font-display text-2xl font-bold">
                  {stat.value}
                </div>
              </div>
            ))}
          </div>
        )}

        <!-- Quick Highlights Badges -->
        {stats.length > 0 && (
          <div class="flex flex-wrap gap-3" aria-label="Quick highlights">
            <span class="inline-block bg-sign-green text-white px-4 py-2 rounded-sm font-body text-sm font-medium">
              Premier Bass Fishing
            </span>
            <span class="inline-block bg-sign-green text-white px-4 py-2 rounded-sm font-body text-sm font-medium">
              Crystal Clear Waters
            </span>
            <span class="inline-block bg-sign-green text-white px-4 py-2 rounded-sm font-body text-sm font-medium">
              Full-Service Marina
            </span>
          </div>
        )}
      </div>
    </div>
  </section>

  <!-- Main Content Area -->
  <main class="container mx-auto px-4 py-12 space-y-16">

    <!-- Lake Description Prose -->
    {description && (
      <div class="prose prose-lg max-w-3xl mx-auto">
        <p class="font-body text-lg leading-relaxed text-gray-800">
          {description}
        </p>
      </div>
    )}

    <!-- US1: WHAT TO FISH SECTION (T019-T022) -->
    {fishingSpots && fishingSpots.length > 0 && (
      <AdventureWhatToFish
        features={fishingSpots.map(spot => ({
          title: spot.species.join(', '),
          description: `Depth: ${spot.depth} | Structure: ${spot.structure}`,
          notes: `Access: ${spot.access}`,
        }))}
        title="What to Fish"
        variant="cream"
        columns={2}
        accentColor="sign-green"
      />
    )}

    <!-- US1: WHERE TO FISH SECTION (T023-T034) -->
    {fishingSpots && fishingSpots.length > 0 && (
      <section class="where-to-fish bg-white py-12" aria-labelledby="where-to-fish-heading">
        <div class="container mx-auto px-4">
          <!-- Section Header -->
          <h2
            id="where-to-fish-heading"
            class="font-display text-3xl md:text-4xl font-bold text-brand-brown mb-8"
          >
            Where to Fish
          </h2>

          <!-- Fishing Spots - Full Width Stacking -->
          <div class="space-y-6">
            {fishingSpots.map((spot: FishingSpot) => (
              <article class="bg-white border-l-4 border-l-brand-brown p-6 md:p-8 rounded-sm shadow-sm">
                <!-- Spot Name -->
                <h3 class="font-display text-2xl font-bold text-brand-brown mb-4">
                  {spot.name}
                </h3>

                <!-- 2-Column Grid: Details | Species Badges -->
                <div class="grid md:grid-cols-2 gap-6">
                  <!-- Left Column: Spot Details -->
                  <div class="space-y-2 font-body text-gray-800">
                    <p>
                      <span class="font-bold text-brand-brown">Depth:</span> {spot.depth}
                    </p>
                    <p>
                      <span class="font-bold text-brand-brown">Structure:</span> {spot.structure}
                    </p>
                    <p>
                      <span class="font-bold text-brand-brown">Access:</span> {spot.access}
                    </p>
                  </div>

                  <!-- Right Column: Species Badges -->
                  <div class="species-badges">
                    <p class="font-bold text-brand-brown mb-2 text-sm uppercase tracking-wide">
                      Target Species:
                    </p>
                    <div class="flex flex-wrap gap-2">
                      {spot.species.map((fish: string) => (
                        <span class="inline-block bg-sign-green text-white px-3 py-1 rounded-sm font-body text-sm font-medium">
                          {fish}
                        </span>
                      ))}
                    </div>
                  </div>
                </div>
              </article>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- US2: MARINA & BOAT ACCESS SECTION (T052-T065) -->
    {marinas && marinas.length > 0 && (
      <section class="marina-section bg-brand-cream py-12" aria-labelledby="marina-heading">
        <div class="container mx-auto px-4">
          <!-- Section Header -->
          <h2
            id="marina-heading"
            class="font-display text-3xl md:text-4xl font-bold text-brand-brown mb-8"
          >
            Marina & Boat Access
          </h2>

          <!-- Marina Cards -->
          <div class="space-y-6">
            {marinas.map((marina: Marina) => (
              <article class="bg-white border-l-4 border-l-brand-brown p-8 rounded-sm shadow-sm">
                <!-- Marina Name -->
                <h3 class="font-display text-2xl font-bold text-brand-brown mb-2">
                  {marina.name}
                </h3>
                <p class="font-body text-gray-600 mb-6 italic">
                  {marina.type}
                </p>

                <!-- 2-Column Grid: Services | Boat Launch Info -->
                <div class="grid md:grid-cols-2 gap-8 mb-6">
                  <!-- Services List -->
                  <div>
                    <h4 class="font-bold text-brand-brown mb-3 uppercase tracking-wide text-sm">
                      Services Available:
                    </h4>
                    <ul class="space-y-2 font-body">
                      {marina.services.map((service: string) => (
                        <li class="flex items-start">
                          <span class="text-sign-green font-bold mr-2">•</span>
                          <span>{service}</span>
                        </li>
                      ))}
                    </ul>
                  </div>

                  <!-- Boat Launch & Fees -->
                  <div>
                    <h4 class="font-bold text-brand-brown mb-3 uppercase tracking-wide text-sm">
                      Boat Launch:
                    </h4>
                    <p class="font-body mb-2">
                      Multiple ramps available
                    </p>
                    {marina.fees && (
                      <p class="font-body text-gray-700">
                        <span class="font-bold">Launch Fee:</span> {marina.fees}
                      </p>
                    )}
                  </div>
                </div>

                <!-- Contact Footer -->
                {(marina.hours || marina.contact) && (
                  <div class="border-t border-gray-200 pt-4 mt-4 flex flex-wrap gap-x-6 gap-y-2 font-body text-sm">
                    {marina.hours && (
                      <div>
                        <span class="font-bold text-brand-brown">Hours:</span> {marina.hours}
                      </div>
                    )}
                    {marina.contact && (
                      <div>
                        <span class="font-bold text-brand-brown">Contact:</span>{' '}
                        <a
                          href={`tel:${marina.contact.replace(/\D/g, '')}`}
                          class="text-sign-green hover:underline"
                        >
                          {marina.contact}
                        </a>
                      </div>
                    )}
                  </div>
                )}
              </article>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- US2: CAMPING SECTION (T048-T051) -->
    {gearList.length > 0 && (
      <AdventureCampingList
        title="Camping Facilities"
        facilities={gearList.map(gear => ({
          type: gear.name,
          description: gear.optional ? 'Optional' : 'Recommended',
        }))}
        columns={2}
        variant="cream"
      />
    )}

    <!-- US4: ACTIVITIES SECTION (T077-T083) -->
    {activities && activities.length > 0 && (
      <section class="activities-section bg-white py-12" aria-labelledby="activities-heading">
        <div class="container mx-auto px-4">
          <!-- Section Header -->
          <h2
            id="activities-heading"
            class="font-display text-3xl md:text-4xl font-bold text-brand-brown mb-8"
          >
            Water Activities
          </h2>

          <!-- Activity Cards Grid -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {activities.map((activity: Activity) => (
              <article class="bg-white border-l-4 border-l-sign-green p-6 rounded-sm shadow-sm">
                <h3 class="font-display text-xl font-bold text-brand-brown mb-2">
                  {activity.name}
                </h3>
                <p class="font-body text-gray-700 mb-3">
                  {activity.description}
                </p>
                {activity.season && (
                  <p class="font-body text-sm text-gray-600 mb-2">
                    <span class="font-bold">Best Season:</span> {activity.season}
                  </p>
                )}
                {activity.difficulty && (
                  <span
                    class={`inline-block px-3 py-1 rounded-sm font-body text-xs font-medium ${
                      activity.difficulty.toLowerCase().includes('easy')
                        ? 'bg-sign-green text-white'
                        : activity.difficulty.toLowerCase().includes('moderate')
                        ? 'bg-brand-orange text-white'
                        : 'bg-brand-brown text-white'
                    }`}
                  >
                    {activity.difficulty}
                  </span>
                )}
              </article>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- US4: SEASONAL GUIDE SECTION (T084-T092) -->
    {seasonalGuide && seasonalGuide.length > 0 && (
      <section class="seasonal-guide bg-brand-cream py-12" aria-labelledby="seasonal-heading">
        <div class="container mx-auto px-4">
          <!-- Section Header -->
          <h2
            id="seasonal-heading"
            class="font-display text-3xl md:text-4xl font-bold text-brand-brown mb-8"
          >
            Seasonal Fishing Guide
          </h2>

          <!-- 4-Season Grid -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            {seasonalGuide.map((season: SeasonalGuide) => (
              <article class="bg-white p-6 rounded-sm shadow-sm">
                <!-- Season Name -->
                <h3 class="font-display text-xl font-bold text-brand-brown mb-4 border-b-2 border-b-sign-green pb-2">
                  {season.period}
                </h3>

                <!-- Target Species -->
                <div class="mb-4">
                  <p class="font-bold text-sm uppercase tracking-wide text-brand-brown mb-2">
                    Target Species:
                  </p>
                  <ul class="space-y-1 font-body text-sm">
                    {season.targetSpecies.map((fish: string) => (
                      <li class="flex items-start">
                        <span class="text-sign-green font-bold mr-2">•</span>
                        <span>{fish}</span>
                      </li>
                    ))}
                  </ul>
                </div>

                <!-- Techniques -->
                <div class="mb-4">
                  <p class="font-bold text-sm uppercase tracking-wide text-brand-brown mb-2">
                    Techniques:
                  </p>
                  <p class="font-body text-sm text-gray-700">
                    {season.techniques}
                  </p>
                </div>

                <!-- Water Conditions -->
                {season.conditions && (
                  <div class="mb-4">
                    <p class="font-bold text-sm uppercase tracking-wide text-brand-brown mb-2">
                      Conditions:
                    </p>
                    <p class="font-body text-sm text-gray-700">
                      {season.conditions}
                    </p>
                  </div>
                )}

                <!-- Kim's Note (font-hand) -->
                {season.kimNote && (
                  <div class="mt-4 pt-4 border-t border-gray-200">
                    <p class="font-hand text-sm italic text-brand-brown bg-brand-cream p-3 rounded-sm">
                      {season.kimNote}
                    </p>
                  </div>
                )}
              </article>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- US5: SAFETY & REGULATIONS SECTION (T066-T076) -->
    {regulations && regulations.length > 0 && (
      <section class="regulations-section bg-white py-12" aria-labelledby="regulations-heading">
        <div class="container mx-auto px-4">
          <!-- Section Header -->
          <h2
            id="regulations-heading"
            class="font-display text-3xl md:text-4xl font-bold text-brand-brown mb-8"
          >
            Safety & Regulations
          </h2>

          <!-- Regulation Category Cards -->
          <div class="space-y-6">
            {regulations.map((reg: Regulation) => (
              <article class="bg-brand-cream border-l-4 border-l-brand-orange p-6 rounded-sm shadow-sm">
                <!-- Category Heading -->
                <h3 class="font-display text-xl font-bold text-brand-brown mb-3">
                  {reg.category}
                </h3>

                <!-- Regulation Details -->
                <p class="font-body text-gray-800 leading-relaxed">
                  {reg.details}
                </p>

                <!-- External Link (if provided) -->
                {reg.link && (
                  <div class="mt-3">
                    <a
                      href={reg.link}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="text-sign-green hover:underline font-body text-sm font-medium"
                    >
                      View Official Regulations →
                    </a>
                  </div>
                )}

                <!-- Important Flag Visual Indicator -->
                {reg.important && (
                  <div class="mt-3 inline-block bg-brand-orange text-white px-3 py-1 rounded-sm font-body text-xs font-bold uppercase">
                    Important
                  </div>
                )}
              </article>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- T093-T098: SPEC-11 COMPONENT INTEGRATIONS -->

    <!-- Gear Checklist -->
    {gearList && gearList.length > 0 && (
      <AdventureGearChecklist
        title="What to Bring"
        intro="Make sure you have everything you need for a great day on the water!"
        items={gearList}
        columns={3}
        variant="white"
      />
    )}

    <!-- Related Shop Categories -->
    {relatedShop && relatedShop.length > 0 && (
      <section class="related-shop bg-brand-cream py-12">
        <div class="container mx-auto px-4">
          <h2 class="font-display text-3xl md:text-4xl font-bold text-brand-brown mb-4">
            Shop Before You Go
          </h2>
          <p class="font-body text-gray-700 mb-8 max-w-2xl">
            Stock up on everything you need at WV Wild Outdoors!
          </p>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            {relatedShop.map((category) => (
              <a
                href={category.href}
                class="bg-white p-6 rounded-sm shadow-sm hover:shadow-md transition-shadow border-l-4 border-l-sign-green"
              >
                <h3 class="font-display text-xl font-bold text-brand-brown mb-2">
                  {category.name}
                </h3>
                {category.description && (
                  <p class="font-body text-gray-600 text-sm">
                    {category.description}
                  </p>
                )}
              </a>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- Call to Action -->
    <AdventureCTA
      heading="Stop By Before You Head Out"
      description="Get the latest fishing reports, pick up your license, and grab everything you need for a successful day on the water."
      primaryText="Visit Our Shop"
      primaryHref="/shop/fishing"
      secondaryText="Call Us"
      secondaryHref="tel:+13046134570"
    />

  </main>
</Layout>

<style>
  /* WVWO Compliance: Only rounded-sm allowed */
  .rounded-sm {
    border-radius: 0.125rem;
  }

  /* WVWO Compliance: Scoped to lake-template class */
  .lake-template .rounded-sm {
    border-radius: 0.125rem !important;
  }

  /* Motion preferences */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
</style>
